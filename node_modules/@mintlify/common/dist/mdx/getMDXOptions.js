import { rehypeCodeBlocks, rehypeMdxExtractExamples, rehypeMdxExtractEndpoint, rehypeRawComponents, rehypeZoomImages, remarkFrames, remarkMdxInjectSnippets, remarkMdxRemoveUnusedVariables, remarkRemoveImports, remarkExtractTableOfContents, } from './plugins/index.js';
import rehypeMdxRemoveUnknownJsx from './plugins/rehype/rehypeMdxRemoveUnknownJsx/index.js';
import { remarkMermaid } from './plugins/remark/remarkMermaid.js';
// avoid running extractors unnecessarily
const rehypeExtractors = (mdxExtracts, data) => {
    if (!mdxExtracts)
        return [];
    return [
        [rehypeMdxExtractExamples, mdxExtracts],
        [rehypeMdxExtractEndpoint, data.pageMetadata, data.mintConfig, mdxExtracts],
    ];
};
export const getMDXOptions = ({ data, remarkPlugins = [], rehypePlugins = [], mdxExtracts, }) => {
    return {
        remarkPlugins: [
            [remarkMdxInjectSnippets, data.snippetTreeMap],
            [remarkExtractTableOfContents, mdxExtracts], // modifies tree so cannot be excluded
            remarkMdxRemoveUnusedVariables,
            remarkFrames,
            remarkRemoveImports,
            remarkMermaid,
            ...remarkPlugins,
        ],
        rehypePlugins: [
            [rehypeMdxRemoveUnknownJsx, data.allowedComponents],
            rehypeCodeBlocks,
            ...rehypeExtractors(mdxExtracts, data),
            rehypeRawComponents,
            rehypeZoomImages,
            ...rehypePlugins,
        ],
        format: 'mdx',
        useDynamicImport: true,
    };
};
